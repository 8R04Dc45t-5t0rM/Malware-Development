#include "Functions.h"

int main(void){
#ifdef _WIN64
    PPEB peb = (PPEB) __readgsqword(0x60);
    
    DWORD debug = peb ->BeingDebugged;
    printf("\n>> Debugger Attached ?  0x%x\n",debug);

    PPEB_LDR_DATA LDR = peb->Ldr;
    printf(">> Pointer to PEB_LDR_DATA Object : 0x%p\n",LDR);

    PLIST_ENTRY LoadedModules = &LDR->InMemoryOrderModuleList;
    printf(">> LoadedModules start at :  0x%p\n",LoadedModules);   

    printf("\n>> List of Loaded DLLs \n");
    PrintDLLs(LoadedModules); 

      
#else
printf("uwu");
#endif
    return EXIT_SUCCESS;
}
