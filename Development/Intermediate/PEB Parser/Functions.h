#include<stdio.h>
#include<windows.h>
#include<winternl.h>


void PrintPath(PLDR_DATA_TABLE_ENTRY tempEntry){
      int j=0;
         for ( PWSTR i = tempEntry->FullDllName.Buffer ; j <tempEntry->FullDllName.Length/sizeof(wchar_t) ; i++,j++){
         printf("%s",i);
         }       
}


void PrintDLLs(PLIST_ENTRY LoadedModules){
PLDR_DATA_TABLE_ENTRY  tempEntry = NULL;

for(PLIST_ENTRY temp = LoadedModules->Flink; temp != LoadedModules ; temp=temp->Flink){
    tempEntry =(PLDR_DATA_TABLE_ENTRY)((PBYTE)temp - sizeof(LIST_ENTRY));
    printf("** ");
    PrintPath(tempEntry);
    printf(" ->  Loaded at 0x%p\n",(tempEntry->DllBase));
 }

}
