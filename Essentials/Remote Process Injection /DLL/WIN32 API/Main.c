#include "Functions.h"

int main(){
   int PID =  getProcessID("Notepad.exe");
   HANDLE processHandle = OpenProcess(PROCESS_ALL_ACCESS,FALSE,PID);

    if(processHandle == NULL){
        printf("Failed to get Process Handle.");
        return 0;
    }

    // the Dll path in system
    wchar_t DLLPath[] =L" /*insert path here*/ ";
    SIZE_T pathSize = sizeof(DLLPath);
    
    // get the address of the load funtion
    HMODULE KernellDLL = GetModuleHandleW(L"kernel32");
    LPTHREAD_START_ROUTINE Function_to_execute = GetProcAddress(KernellDLL,"LoadLibraryW");

    // allocate memeory to write the DLL path
    LPVOID allocated_memory = VirtualAllocEx(processHandle, NULL, pathSize, (MEM_COMMIT | MEM_RESERVE), PAGE_READWRITE);
    SIZE_T bytes=0;

    // write the path into the allocated memory
    WriteProcessMemory(processHandle, allocated_memory, DLLPath, pathSize, &bytes);


    DWORD thread_ID;
    HANDLE threadHandle=CreateRemoteThread(processHandle, NULL, 0, Function_to_execute , allocated_memory, 0, &thread_ID);

    WaitForSingleObject(threadHandle,INFINITE);
}
